(this.webpackJsonporigin=this.webpackJsonporigin||[]).push([[0],{17:function(e,t,a){e.exports=a(33)},33:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),s=a(12),r=a.n(s),o=a(15);const i=Object(o.a)("https://wnovshdbuptvlpjdmebs.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indub3ZzaGRidXB0dmxwamRtZWJzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQyOTkwMjQsImV4cCI6MjA1OTg3NTAyNH0.XGnuY84t-gAckLF4kas-e9lrslpMcuuwytyQsm6QU1g");var u=function(){const[e,t]=Object(l.useState)([]),[a,s]=Object(l.useState)([]),[r,o]=Object(l.useState)(""),[u,c]=Object(l.useState)([]),m=Object(l.useRef)(null);Object(l.useEffect)(()=>{i.auth.getSession().then(e=>{let{data:{session:a}}=e;t(a)});const{data:{subscription:e}}=i.auth.onAuthStateChange((e,a)=>{t(a)});return()=>e.unsubscribe()},[]),console.log(e);const d=async()=>{await i.auth.signInWithOAuth({provider:"google"})},v=async()=>{const{error:e}=await i.auth.signOut();e&&console.log("Sign-out error",e.message)};Object(l.useEffect)(()=>{var t;if(!(null===e||void 0===e?void 0:e.user))return void c([]);const l=i.channel("room_one",{config:{presence:{key:null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.id}}});return l.on("broadcast",{event:"message"},e=>{s(t=>[...t,e.payload]),console.log(a)}),l.subscribe(async t=>{var a;"SUBSCRIBED"===t&&await l.track({id:null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.id})}),l.on("presence",{event:"sync"},()=>{const e=l.presenceState();c(Object.keys(e))}),()=>{l.unsubscribe()}},[e]);const g=async t=>{var a,l,n,s;t.preventDefault(),i.channel("room_one").send({type:"broadcast",event:"Message",payload:{message:r,user_name:null===e||void 0===e||null===(a=e.user)||void 0===a||null===(l=a.user_metadata)||void 0===l?void 0:l.email,avatar:null===e||void 0===e||null===(n=e.user)||void 0===n||null===(s=n.user_metadata)||void 0===s?void 0:s.avatar_url,timestamp:(new Date).toISOString()}}),o("")};var p,f;return Object(l.useEffect)(()=>{setTimeout(()=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)},[100])},[a]),e?n.a.createElement("div",{className:"w-full flex h-screen justify-center items-center p-4"},n.a.createElement("div",{className:"border-[1px] border-gray-700 max-w-6xl w-full min-h-[600px] rounded-lg"},n.a.createElement("div",{className:"flex justify-between h-20 border-b-[1px] border-gray-700"},n.a.createElement("div",{className:"p-4"},n.a.createElement("p",{className:"text-gray-300"},"Signed in as name: ",null===e||void 0===e||null===(p=e.user)||void 0===p||null===(f=p.user_metadata)||void 0===f?void 0:f.full_name),n.a.createElement("p",{className:"text-gray-300 italic text-sm"},u.length," user online")),n.a.createElement("button",{onClick:v,className:"m-2 sm:mr-4 text-white"},"Sign Out")),n.a.createElement("div",{ref:m,className:"p-4 flex flex-col overflow-y-auto h-[500px]"},a.map((t,a)=>{var l,s,r,o,i,u;return n.a.createElement("div",{key:a,className:"my-2 flex w-full items-start "+((null===t||void 0===t?void 0:t.user_name)===(null===e||void 0===e||null===(l=e.user)||void 0===l?void 0:l.email)?"justify-end":"justify-start")},t.user_name!==(null===e||void 0===e||null===(s=e.user)||void 0===s?void 0:s.email)&&n.a.createElement("img",{src:t.avatar,alt:"U2",className:"w-10 h-10 rounded-full mr-2"}),n.a.createElement("div",{className:"flex flex-col w-full"},n.a.createElement("div",{className:"p-1 max-w-[70%] rounded -xl "+(t.user_name===(null===e||void 0===e||null===(r=e.user)||void 0===r?void 0:r.email)?"bg-gray-700 text-white ml-auto":"bg-gray-500 text-white mr-auto")},n.a.createElement("p",null,t.message)),n.a.createElement("div",{className:"text-xs opacity-75 pt-1 "+((null===t||void 0===t?void 0:t.user_name)===(null===e||void 0===e||null===(o=e.user)||void 0===o?void 0:o.email)?"text-right mr-2":"text-left-ml-2")},(u=null===t||void 0===t?void 0:t.timestamp,new Date(u).toLocaleTimeString("en-us",{hour:"numeric",minute:"2-digit",hour12:!1})))),t.user_name===(null===e||void 0===e||null===(i=e.user)||void 0===i?void 0:i.email)&&n.a.createElement("img",{src:t.avatar,alt:"U2",className:"w-10 h-10 rounded-full ml-2"}))})),n.a.createElement("form",{onSubmit:g,className:"flex flex-col sm:flex-row p-4 border-t-[1px] border-gray-700"},n.a.createElement("input",{value:r,onChange:e=>o(e.target.value),type:"text",placeholder:"Type a message...",className:"p-2 w-full bg-[#00000040] rounded-lg"}),n.a.createElement("button",{className:"mt-4 sm:mt-0 sm:ml-8 text-white max-h-12"},"Send"),n.a.createElement("span",null)))):n.a.createElement("div",{className:"w-full flex h-screen justify-center items-center p-4"},n.a.createElement("button",{onClick:d},"Sign in with Google"))};r.a.createRoot(document.getElementById("root")).render(n.a.createElement(u,null));t.default=function(){return n.a.createElement("h1",null,"Hello from React \ud83d\udc4b")}}},[[17,1,2]]]);
//# sourceMappingURL=main.c7e654bb.chunk.js.map